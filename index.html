<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ateliê Patrícia Reis</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  font-family: Arial, sans-serif;
  background:#f4f6f9;
  margin:0;
  padding:20px;
}
.container{
  max-width:900px;
  margin:auto;
}
h1{
  text-align:center;
  color:#5f7fa6;
}
input, select{
  width:100%;
  padding:10px;
  margin-bottom:10px;
  border-radius:6px;
  border:1px solid #ccc;
}
button{
  width:100%;
  padding:12px;
  background:#5f7fa6;
  color:white;
  border:none;
  border-radius:6px;
  font-weight:bold;
  cursor:pointer;
  margin-top:10px;
}
.resultado{
  background:#e9edf2;
  padding:20px;
  border-radius:10px;
  margin-top:15px;
  font-size:14px;
  line-height:1.7;
}
.titulo{
  font-weight:bold;
  color:#5f7fa6;
  margin-top:15px;
}
</style>
</head>

<body>

<div class="container">

<h1>ATELIÊ PATRÍCIA REIS</h1>

<input id="largura" placeholder="Largura (m)">
<input id="altura" placeholder="Altura (m)">
<input id="barra" placeholder="Barra (cm)">

<select id="modelo">
  <option>Prega Macho</option>
  <option>Wave</option>
  <option>Franzido</option>
  <option>Ilhós</option>
  <option>Prega Americana</option>
</select>

<select id="modeloForro">
  <option>Franzido</option>
  <option>Estilo Painel</option>
</select>

<select id="forro">
  <option value="0">Sem Forro</option>
  <option value="31">Blackout 100%</option>
  <option value="23">Blackout 70%</option>
  <option value="13">Microfibra</option>
</select>

<input id="presilhas" placeholder="Presilhas (un)">
<input id="instalacao" placeholder="Instalação (R$)">

<h3>Mão de Obra (valor por metro linear)</h3>
<input id="maoSemForro" value="150" placeholder="Valor sem forro">
<input id="maoComForro" value="200" placeholder="Valor com forro">

<button onclick="calcular()">Calcular</button>

<div id="resultado" class="resultado"></div>

<hr>

<h2>Orçamento para Cliente</h2>
<input id="cliente" placeholder="Nome do Cliente">
<input id="entradaPercent" value="60">
<input id="entregaPercent" value="40">
<button onclick="gerarPDF()">Gerar PDF</button>

</div>

<script>

let dadosPDF = {};
let valorFinalGlobal = 0;

function calcular(){

  const largura = parseFloat(document.getElementById("largura").value) || 0;
  const altura = parseFloat(document.getElementById("altura").value) || 0;
  const barraCM = parseFloat(document.getElementById("barra").value) || 0;

  const modelo = document.getElementById("modelo").value;
  const modeloForro = document.getElementById("modeloForro").value;
  const valorForroMetro = parseFloat(document.getElementById("forro").value);

  const presilhas = parseInt(document.getElementById("presilhas").value) || 0;
  const instalacao = parseFloat(document.getElementById("instalacao").value) || 0;

  const maoSemForro = parseFloat(document.getElementById("maoSemForro").value) || 0;
  const maoComForro = parseFloat(document.getElementById("maoComForro").value) || 0;

  const larguraTecido = 3;
  const cabecalho = 0.12;
  const alturaFinal = altura + cabecalho + (barraCM/100);

  // GAZE
  const alturasGaze = Math.ceil((largura * 3.5) / larguraTecido);
  const metragemGaze = alturasGaze * alturaFinal;

  // FORRO
  let alturasForro = 0;
  let metragemForro = 0;

  if(valorForroMetro !== 0){
    alturasForro = Math.ceil((largura * 2) / larguraTecido);
    metragemForro = alturasForro * alturaFinal;
  }

  // PREÇOS FIXOS
  const precoGaze = 26;
  const precoEntretela = 1.60;
  const precoRodizio = 0.12;
  const precoPresilha = 1.60;
  const precoTrilho = 15;

  const custoGaze = metragemGaze * precoGaze;
  const custoForro = metragemForro * valorForroMetro;
  const custoEntretela = metragemGaze * precoEntretela;

  const rodiziosBase = Math.ceil(largura * 10);
  const rodizios = valorForroMetro !== 0 ? rodiziosBase * 2 : 0;
  const custoRodizio = rodizios * precoRodizio;

  const custoPresilha = presilhas * precoPresilha;
  const custoTrilho = largura * precoTrilho;

  const custoMateriais = custoGaze + custoForro + custoEntretela + custoRodizio + custoPresilha + custoTrilho;

  // MÃO DE OBRA POR METRO LINEAR
  let maoObraCalculada = 0;

  if(valorForroMetro !== 0){
    maoObraCalculada = largura * maoComForro;
  } else {
    maoObraCalculada = largura * maoSemForro;
  }

  const totalProjeto = custoMateriais + maoObraCalculada + instalacao;
  valorFinalGlobal = totalProjeto;

  dadosPDF = {
    modelo,
    modeloForro,
    tipoForro: document.getElementById("forro").selectedOptions[0].text,
    largura,
    altura,
    barraCM
  };

  document.getElementById("resultado").innerHTML = `
  <div class="titulo">ALTURA FINAL</div>
  Altura base: ${altura.toFixed(2)} m<br>
  Barra: ${(barraCM/100).toFixed(2)} m<br>
  Cabeçalho: 0.12 m<br>
  <b>Altura final de corte: ${alturaFinal.toFixed(2)} m</b><br>

  <div class="titulo">GAZE</div>
  Alturas: ${alturasGaze}<br>
  Metragem: ${metragemGaze.toFixed(2)} m<br>
  Valor: R$ ${custoGaze.toFixed(2)}<br>

  <div class="titulo">FORRO</div>
  Alturas: ${alturasForro}<br>
  Metragem: ${metragemForro.toFixed(2)} m<br>
  Valor: R$ ${custoForro.toFixed(2)}<br>

  <div class="titulo">MATERIAIS</div>
  Entretela: R$ ${custoEntretela.toFixed(2)}<br>
  Rodízios: ${rodizios} un → R$ ${custoRodizio.toFixed(2)}<br>
  Presilhas: ${presilhas} un → R$ ${custoPresilha.toFixed(2)}<br>
  Trilho: R$ ${custoTrilho.toFixed(2)}<br>
  <b>Custo Total Materiais: R$ ${custoMateriais.toFixed(2)}</b><br>

  <div class="titulo">FINANCEIRO</div>
  Mão de Obra: R$ ${maoObraCalculada.toFixed(2)}<br>
  Instalação: R$ ${instalacao.toFixed(2)}<br>
  <h3>Total do Projeto: R$ ${totalProjeto.toFixed(2)}</h3>
  `;
}

function gerarPDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();

  const cliente = document.getElementById("cliente").value || "Cliente";
  const entrada = document.getElementById("entradaPercent").value;
  const entrega = document.getElementById("entregaPercent").value;
  const data = new Date().toLocaleDateString();

  doc.setFontSize(16);
  doc.setTextColor(95,127,163);
  doc.text("ATELIÊ PATRÍCIA REIS",105,20,{align:"center"});

  doc.setTextColor(0,0,0);
  doc.setFontSize(11);

  doc.text(`Cliente: ${cliente}`,20,40);
  doc.text(`Data: ${data}`,20,48);

  doc.text(`Modelo da Cortina: ${dadosPDF.modelo}`,20,60);
  doc.text(`Tecido Principal: Gaze de Linho`,20,68);
  doc.text(`Modelo do Forro: ${dadosPDF.modeloForro}`,20,76);
  doc.text(`Tipo de Forro: ${dadosPDF.tipoForro}`,20,84);
  doc.text(`Trilho: Trilho de teto`,20,92);

  doc.text(`Medidas: ${dadosPDF.largura.toFixed(2)}L x ${dadosPDF.altura.toFixed(2)}A`,20,100);
  doc.text(`Barra: ${dadosPDF.barraCM} cm`,20,108);

  doc.setFontSize(14);
  doc.setTextColor(95,127,163);
  doc.text("VALOR TOTAL DO PROJETO",105,140,{align:"center"});

  doc.setFontSize(20);
  doc.setTextColor(0,0,0);
  doc.text(`R$ ${valorFinalGlobal.toFixed(2)}`,105,155,{align:"center"});

  doc.setFontSize(11);
  doc.text("Valor referente à confecção, fornecimento de materiais e instalação conforme especificações acima.",105,165,{align:"center"});

  doc.text(`${entrada}% de entrada para início da confecção.`,20,185);
  doc.text(`${entrega}% na entrega e instalação.`,20,193);
  doc.text("Aceitamos Pix, dinheiro e cartão de crédito em até 3x com juros.",20,201);

  doc.text("Prazo: até 15 dias úteis após confirmação da entrada.",20,213);
  doc.text("Validade desta proposta: 7 dias.",20,221);

  doc.line(20,235,190,235);

  doc.text("_____________________________________",20,260);
  doc.text("Patrícia Reis",20,268);

  doc.text("_____________________________________",120,260);
  doc.text("Assinatura do Cliente",120,268);

  doc.save("Orcamento_Atelie_Patricia_Reis.pdf");
}

</script>

</body>
</html>
